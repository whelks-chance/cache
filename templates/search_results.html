{% extends 'base.html' %}
{% load static %}

{% block main %}


    <div class="page-header" id="banner">
        <div class="row">
            <div class="col-lg-8 col-md-7 col-sm-6">
                <h1>CaCHE is the UKâ€™s Collaborative Centre for Housing Evidence</h1>
                <p class="lead">A consortium of 12 partners led by the University of Glasgow. It is a five-year programme funded by the Economic and Social Research Council, Joseph Rowntree Foundation and the Arts and Humanities Research Council</p>
            </div>
            <div class="col-lg-4 col-md-5 col-sm-6">
                <div class="sponsor">
                    <a href="#">
                        <img src="{% static 'img/media_553190_en.png' %}">
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="bs-docs-section clearfix">

        <div class="row">
            <div class="col-lg-12">
                <h3>{{ search_term }}</h3>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1 id="tables">Tables</h1>
                </div>

                <div class="bs-component">
                    <table class="table table-striped table-hover table-bordered" id="results_table">
                        <thead class="thead-dark">
                        <tr>
                            <th>Date</th>
                            <th>Data Type</th>
                            <th>Dataset desciption</th>
                            <th>View</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>1</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        <tr class="table-info">
                            <td>3</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        <tr class="table-success">
                            <td>4</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        <tr class="table-danger">
                            <td>5</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        <tr class="table-warning">
                            <td>6</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        <tr class="table-active">
                            <td>7</td>
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>Column content</td>
                        </tr>
                        </tbody>
                    </table>
                </div><!-- /example -->
            </div>
        </div>
    </div>


    <script type="text/javascript" src="{% static 'js/search_results.js' %}"></script>
{#    <script src="{% static 'jquery/jquery.min.js' %}"></script>#}
{#    <script src="{% static 'datatables/jquery.dataTables.min.js' %}"></script>#}
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="{% static 'moment/moment-with-locales.min.js' %}"></script>

    <script>
        $(document).ready(function(){
            var survey_table = $('#results_table').DataTable({
                serverSide: false,
                processing: true,
                "bAutoWidth": false,
                responsive: true,
                "pageLength": 30,
                {#                "oLanguage": datatables_language,#}
                ajax: {
                    url: "{% url 'ckan_search'%}?search_term={{ search_term }}",
                    type: 'GET',
                    data: function (d) {},
                    dataSrc: function ( json ) {
                        return json['data'];
                    }
                },
                columns: [
{
                        "targets": -1,
                        "data": 'created',
                        "render": function ( data, type, full, meta ) {
                            return new moment(data).format('do MMMM YYYY');
                        }
                    },
                    {'data': 'format'},
                    {'data': 'description'},
                    {
                        "targets": -1,
                        "data": 'id',
                        "render": function ( data, type, full, meta ) {
                            return "<a target='_blank' " +
                                "href='" + {% url 'ckan_resource' %} +
                                    "?uuid=" + data + "' class='btn btn-success'>View</a>";
                        }
                    }
                ]
            });
        });
    </script>
{% endblock %}